---
title: "Nighthold DPS Comparison - Heroic"
author: "JyuNyar"
date: "Feb 2, 2017"
output: 
  html_document:
    toc: true
    toc_float: true
    keep_md: true
---

```{r setup,echo=FALSE, results='hide', message=FALSE, warning=FALSE}
library(ggplot2)
library(plyr)
library(dplyr)
parses=read.csv("C:/Users/JyuNyar/Documents/R-Studio/WoW/parses.csv")
parses.filtered=parses%>%group_by(spec2,Fight,difficulty)%>%mutate(Count=n(),Omit=ifelse(Count<100,1,0))%>%filter(Omit==0,itemLevel>865)%>%ungroup()%>%group_by(spec2)%>%mutate(fullMedian=median(total))%>%ungroup()%>%group_by(spec2,Fight,difficulty)%>%mutate(lower = (median(total)-2.5*mad(total)),medianDPS=median(total),upper = (median(total)+2.5*mad(total)))%>%ungroup()%>%mutate(Outlier=ifelse(total<lower,1,ifelse(total>upper,1,0)))%>%filter(Outlier==0)
```

#Data Summary

Item level Distribution Heroic: 

###Heroic ilvl Distribution
```{r heroic_hist,fig.width=6,fig.height=5,dpi=200}
ggplot(parses%>%filter(difficulty=="Heroic",itemLevel>865),aes(x=itemLevel))+geom_histogram(binwidth=1)+ggtitle("ilvl Distrution for all Heroic Parses")
```

###Mythic ilvl Distribution
```{r mythic_hist,fig.width=6,fig.height=5,dpi=200}
ggplot(parses%>%filter(difficulty=="Mythic",itemLevel>865),aes(x=itemLevel))+geom_histogram(binwidth=1)+ggtitle("ilvl Distrution for all Mythic Parses")
```


##Data Cleanup

Data was cleaned using the median absolute deviation. For each spec + fight + difficulty combination, an exclusion criterion was calculated as follows:

$$Lower Bound = median - 2.5*MAD$$
$$Upper Bound = median + 2.5*MAD$$

Observations that fell either below the lower bound, or above the upper bound, were excluded.

```{r data_setup, message=FALSE, warning=FALSE}
parses.filtered=parses%>%
  group_by(spec2,Fight,difficulty)%>%
  mutate(
    Count=n(),
    Omit=ifelse(Count<100,1,0))%>%
  filter(Omit==0,itemLevel>865)%>%
  ungroup()%>%
  group_by(spec2)%>%
  mutate(
    fullMedian=median(total))%>%
  ungroup()%>%
  group_by(spec2,Fight,difficulty)%>%
  mutate(
    lower = (median(total)-2.5*mad(total)),
    medianDPS=median(total),
    upper = (median(total)+2.5*mad(total)))%>%
  ungroup()%>%
  mutate(
    Outlier=ifelse(total<lower,1,
                   ifelse(total>upper,1,0)))%>%
  filter(Outlier==0)
```

Plotting function:

```{r boxplot_function}
boxplot=function(fight,diff,pal,data){
    ggplot(
      data%>%
        filter(Fight==fight,difficulty==diff),aes(x=reorder(spec2,medianDPS),y=total,color=spec2))+
    geom_boxplot(lwd=1)+
    scale_colour_manual(values=pal)+
    theme(
      axis.text.x=element_text(angle=90,vjust=1),
      axis.title.x=element_blank(),
      text=element_text(size=16))+
    labs(title=fight)
}
```

Palette:
```{r palette}
palette.alphabetical=c("#9482C9","#69CCF0","#C79C6E","#EDC84F","#FF7D0A","#ABD473","#7661B2","#BDAEE8","#0070DE","#63AAF0","#FFAA60","#2AC1F8","#48AACD","#C41F3B","#9B7954","#A330C9","#8BD428","#FFC300","#F58CBA","#000000","#E3C153","#BDD69A","#97001A","#00FF96")
```

#Heroic {.tabset}
##Overall
```{r heroic_all,fig.width=14,fig.height=5,dpi=200,message=FALSE, warning=FALSE}
parses.filtered=parses.filtered%>%ungroup()%>%group_by(spec2,difficulty)%>%mutate(medianDPSOverall=median(total))
ggplot(
      parses.filtered%>%filter(difficulty=="Heroic"),aes(x=reorder(spec2,medianDPSOverall),y=total,color=spec2))+
    geom_boxplot(lwd=1)+
    scale_colour_manual(values=palette.alphabetical)+
    theme(
      axis.text.x=element_text(angle=90,vjust=1),
      axis.title.x=element_blank(),
      text=element_text(size=16))+
    labs(title="Heroic Nighthold")
```

##Heroic Skorpyron
```{r heroic_skorpyron,fig.width=14,fig.height=5,dpi=200,message=FALSE, warning=FALSE}
boxplot("Skorpyron","Heroic",palette.alphabetical,parses.filtered)
```

##Heroic Chronomatic Anomaly
```{r heroic_anomaly,fig.width=14,fig.height=5,dpi=200,message=FALSE, warning=FALSE}
boxplot("Chronomatic Anomaly","Heroic",palette.alphabetical,parses.filtered)

```

##Heroic Trilliax
```{r heroic_trilliax,fig.width=14,fig.height=5,dpi=200,message=FALSE, warning=FALSE}
boxplot("Trilliax","Heroic",palette.alphabetical,parses.filtered)
```

##Heroic Spellblade Aluriel
```{r heroic_aluriel,fig.width=14,fig.height=5,dpi=200,message=FALSE, warning=FALSE}
boxplot("Spellblade Aluriel","Heroic",palette.alphabetical,parses.filtered)
```

##Heroic Tichondrius
```{r heroic_tichondrius,fig.width=14,fig.height=5,dpi=200,message=FALSE, warning=FALSE}
boxplot("Tichondrius","Heroic",palette.alphabetical,parses.filtered)
```

##Heroic Krosus
```{r heroic_krosus,fig.width=14,fig.height=5,dpi=200,message=FALSE, warning=FALSE}
boxplot("Krosus","Heroic",palette.alphabetical,parses.filtered)
```

##Heroic High Botanist Tel'arn
```{r heroic_botanist,fig.width=14,fig.height=5,dpi=200,message=FALSE, warning=FALSE}
boxplot("High Botanist Tel'arn","Heroic",palette.alphabetical,parses.filtered)
```

##Heroic Grand Magistrix Elisande
```{r heroic_elisande,fig.width=14,fig.height=5,dpi=200,message=FALSE, warning=FALSE}
boxplot("Grand Magistrix Elisande","Heroic",palette.alphabetical,parses.filtered)
```

##Heroic Gul'dan
```{r heroic_guldan,fig.width=14,fig.height=5,dpi=200,message=FALSE, warning=FALSE}
boxplot("Gul'dan","Heroic",palette.alphabetical,parses.filtered)
```

#Mythic {.tabset}
##Overall
```{r Mythic_all,fig.width=14,fig.height=5,dpi=200,message=FALSE, warning=FALSE}
parses.filtered=parses.filtered%>%ungroup()%>%group_by(spec2,difficulty)%>%mutate(medianDPSOverall=median(total))
ggplot(
      parses.filtered%>%filter(difficulty=="Mythic"),aes(x=reorder(spec2,medianDPSOverall),y=total,color=spec2))+
    geom_boxplot(lwd=1)+
    scale_colour_manual(values=palette.alphabetical)+
    theme(
      axis.text.x=element_text(angle=90,vjust=1),
      axis.title.x=element_blank(),
      text=element_text(size=16))+
    labs(title="Mythic Nighthold")
```

##Mythic Skorpyron
```{r Mythic_skorpyron,fig.width=14,fig.height=5,dpi=200,message=FALSE, warning=FALSE}
boxplot("Skorpyron","Mythic",palette.alphabetical,parses.filtered)
```

##Mythic Chronomatic Anomaly
```{r Mythic_anomaly,fig.width=14,fig.height=5,dpi=200,message=FALSE, warning=FALSE}
boxplot("Chronomatic Anomaly","Mythic",palette.alphabetical,parses.filtered)

```

##Mythic Trilliax
```{r Mythic_trilliax,fig.width=14,fig.height=5,dpi=200,message=FALSE, warning=FALSE}
boxplot("Trilliax","Mythic",palette.alphabetical,parses.filtered)
```

##Mythic Spellblade Aluriel
```{r Mythic_aluriel,fig.width=14,fig.height=5,dpi=200,message=FALSE, warning=FALSE}
boxplot("Spellblade Aluriel","Mythic",palette.alphabetical,parses.filtered)
```

##Mythic Tichondrius
```{r Mythic_tichondrius,fig.width=14,fig.height=5,dpi=200,message=FALSE, warning=FALSE}
boxplot("Tichondrius","Mythic",palette.alphabetical,parses.filtered)
```

##Mythic Krosus
```{r Mythic_krosus,fig.width=14,fig.height=5,dpi=200,message=FALSE, warning=FALSE}
boxplot("Krosus","Mythic",palette.alphabetical,parses.filtered)
```

##Mythic High Botanist Tel'arn
```{r Mythic_botanist,fig.width=14,fig.height=5,dpi=200,message=FALSE, warning=FALSE}
boxplot("High Botanist Tel'arn","Mythic",palette.alphabetical,parses.filtered)
```

##Mythic Grand Magistrix Elisande
```{r Mythic_elisande,fig.width=14,fig.height=5,dpi=200,message=FALSE, warning=FALSE}
boxplot("Grand Magistrix Elisande","Mythic",palette.alphabetical,parses.filtered)
```

##Mythic Gul'dan
```{r Mythic_guldan,fig.width=14,fig.height=5,dpi=200,message=FALSE, warning=FALSE}
boxplot("Gul'dan","Mythic",palette.alphabetical,parses.filtered)
```
